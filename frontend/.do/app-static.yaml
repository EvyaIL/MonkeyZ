# ULTRA-FAST DigitalOcean Static Site Configuration
# This configuration deploys in 2-3 minutes instead of 15-20 minutes

alerts:
- rule: DEPLOYMENT_FAILED
- rule: DOMAIN_FAILED

domains:
- domain: monkeyz.co.il
  type: PRIMARY
  zone: monkeyz.co.il
- domain: www.monkeyz.co.il
  type: ALIAS
  zone: monkeyz.co.il

# Static site service - FASTEST deployment option
static_sites:
- name: monkeyz-frontend
  github:
    repo: EvyaIL/MonkeyZ
    branch: main
    deploy_on_push: true
  source_dir: frontend/
  output_dir: build/
  
  # Optimized build command for speed
  build_command: |
    npm ci --silent --no-audit --no-fund --prefer-offline &&
    GENERATE_SOURCEMAP=false CI=true npm run build
  
  # Environment variables for build
  envs:
  - key: REACT_APP_API_URL
    value: https://api.monkeyz.co.il
    scope: BUILD_TIME
  - key: REACT_APP_PAYPAL_CLIENT_ID
    value: AXu-4q2i_746jXHFnUbYUSDxSHZF5og7QtErtmy9eJHkzBpumtDFLpJz6OQollNpRDFlqP2w3rg7DiCF
    scope: BUILD_TIME
  - key: REACT_APP_GOOGLE_CLIENT_ID
    value: 946645411512-tn9qmppcsnp5oqqo88ivkuapou2cmg53.apps.googleusercontent.com
    scope: BUILD_TIME
  - key: REACT_APP_GA_MEASUREMENT_ID
    value: G-SYF721LFGB
    scope: BUILD_TIME
  - key: REACT_APP_GTM_ID
    value: GTM-P4FNQL6X
    scope: BUILD_TIME
  - key: NODE_ENV
    value: production
    scope: BUILD_TIME
  - key: GENERATE_SOURCEMAP
    value: "false"
    scope: BUILD_TIME
  - key: CI
    value: "true"
    scope: BUILD_TIME

  # Route configuration
  routes:
  - path: /
  
  # Error document for SPA routing
  error_document: index.html

  # Index document
  index_document: index.html

  # CORS configuration if needed
  cors:
    allow_origins:
    - exact: https://api.monkeyz.co.il
    allow_methods:
    - GET
    - POST
    - PUT
    - DELETE
    allow_headers:
    - Content-Type
    - Authorization

name: monkeyz-static
region: fra

# Features for optimization
features:
- buildpack-stack=ubuntu-22

{"timestamp": "2025-09-05T11:35:27.196077Z", "level": "INFO", "logger": "root", "message": "Logging configured successfully", "module": "logging_config", "function": "setup_logging", "line": 162}
{"timestamp": "2025-09-05T11:35:27.197003Z", "level": "INFO", "logger": "main", "message": "Starting MonkeyZ API application...", "module": "main", "function": "<module>", "line": 36}
{"timestamp": "2025-09-05T11:35:27.380901Z", "level": "INFO", "logger": "src.middleware.security_middleware", "message": "Security middleware initialized (development: True)", "module": "security_middleware", "function": "__init__", "line": 110}
{"timestamp": "2025-09-05T11:35:27.381946Z", "level": "INFO", "logger": "main", "message": "Starting application initialization...", "module": "main", "function": "startup_event", "line": 212}
{"timestamp": "2025-09-05T11:35:27.382844Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Initializing database connection...", "module": "database_manager", "function": "initialize_database", "line": 337}
{"timestamp": "2025-09-05T11:35:31.272153Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Database connection established successfully", "module": "database_manager", "function": "connect", "line": 177}
{"timestamp": "2025-09-05T11:35:31.272771Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Database initialization completed successfully", "module": "database_manager", "function": "initialize_database", "line": 340}
{"timestamp": "2025-09-05T11:35:31.273404Z", "level": "INFO", "logger": "main", "message": "Application initialization completed successfully", "module": "main", "function": "startup_event", "line": 225}
{"timestamp": "2025-09-05T11:35:32.123170Z", "level": "INFO", "logger": "root", "message": "Successfully initialized 3 database collections with Beanie ODM", "module": "user_controller", "function": "initialize", "line": 62}
{"timestamp": "2025-09-05T12:35:07.740300Z", "level": "INFO", "logger": "root", "message": "Logging configured successfully", "module": "logging_config", "function": "setup_logging", "line": 162}
{"timestamp": "2025-09-05T12:35:07.740693Z", "level": "INFO", "logger": "main", "message": "Starting MonkeyZ API application...", "module": "main", "function": "<module>", "line": 36}
{"timestamp": "2025-09-05T12:35:07.832054Z", "level": "INFO", "logger": "src.middleware.security_middleware", "message": "Security middleware initialized (development: True)", "module": "security_middleware", "function": "__init__", "line": 110}
{"timestamp": "2025-09-05T12:35:07.832882Z", "level": "INFO", "logger": "main", "message": "Starting application initialization...", "module": "main", "function": "startup_event", "line": 212}
{"timestamp": "2025-09-05T12:35:07.833447Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Initializing database connection...", "module": "database_manager", "function": "initialize_database", "line": 337}
{"timestamp": "2025-09-05T12:35:08.982084Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Database connection established successfully", "module": "database_manager", "function": "connect", "line": 177}
{"timestamp": "2025-09-05T12:35:08.982457Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Database initialization completed successfully", "module": "database_manager", "function": "initialize_database", "line": 340}
{"timestamp": "2025-09-05T12:35:08.982943Z", "level": "INFO", "logger": "main", "message": "Application initialization completed successfully", "module": "main", "function": "startup_event", "line": 225}
{"timestamp": "2025-09-05T12:35:09.770248Z", "level": "INFO", "logger": "root", "message": "Successfully initialized 3 database collections with Beanie ODM", "module": "user_controller", "function": "initialize", "line": 62}
{"timestamp": "2025-09-05T12:40:13.496466Z", "level": "INFO", "logger": "main", "message": "Starting application shutdown...", "module": "main", "function": "shutdown_event", "line": 230}
{"timestamp": "2025-09-05T12:40:13.496990Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Cleaning up database connections...", "module": "database_manager", "function": "cleanup_database", "line": 347}
{"timestamp": "2025-09-05T12:40:13.572607Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Database cleanup completed", "module": "database_manager", "function": "cleanup_database", "line": 349}
{"timestamp": "2025-09-05T12:40:13.573216Z", "level": "INFO", "logger": "main", "message": "Application shutdown completed", "module": "main", "function": "shutdown_event", "line": 232}
{"timestamp": "2025-09-05T12:40:22.345229Z", "level": "INFO", "logger": "root", "message": "Logging configured successfully", "module": "logging_config", "function": "setup_logging", "line": 162}
{"timestamp": "2025-09-05T12:40:22.345532Z", "level": "INFO", "logger": "main", "message": "Starting MonkeyZ API application...", "module": "main", "function": "<module>", "line": 36}
{"timestamp": "2025-09-05T12:40:22.427375Z", "level": "INFO", "logger": "src.middleware.security_middleware", "message": "Security middleware initialized (development: True)", "module": "security_middleware", "function": "__init__", "line": 110}
{"timestamp": "2025-09-05T12:40:22.427887Z", "level": "INFO", "logger": "main", "message": "Starting application initialization...", "module": "main", "function": "startup_event", "line": 212}
{"timestamp": "2025-09-05T12:40:22.428214Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Initializing database connection...", "module": "database_manager", "function": "initialize_database", "line": 337}
{"timestamp": "2025-09-05T12:40:23.506598Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Database connection established successfully", "module": "database_manager", "function": "connect", "line": 177}
{"timestamp": "2025-09-05T12:40:23.506966Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Database initialization completed successfully", "module": "database_manager", "function": "initialize_database", "line": 340}
{"timestamp": "2025-09-05T12:40:23.507420Z", "level": "INFO", "logger": "main", "message": "Application initialization completed successfully", "module": "main", "function": "startup_event", "line": 225}
{"timestamp": "2025-09-05T12:40:24.283777Z", "level": "INFO", "logger": "root", "message": "Successfully initialized 3 database collections with Beanie ODM", "module": "user_controller", "function": "initialize", "line": 62}
{"timestamp": "2025-09-05T13:39:17.913138Z", "level": "INFO", "logger": "root", "message": "Logging configured successfully", "module": "logging_config", "function": "setup_logging", "line": 162}
{"timestamp": "2025-09-05T13:39:17.913580Z", "level": "INFO", "logger": "main", "message": "Starting MonkeyZ API application...", "module": "main", "function": "<module>", "line": 36}
{"timestamp": "2025-09-05T13:39:17.968834Z", "level": "INFO", "logger": "src.middleware.security_middleware", "message": "Security middleware initialized (development: True)", "module": "security_middleware", "function": "__init__", "line": 110}
{"timestamp": "2025-09-05T13:39:17.969072Z", "level": "INFO", "logger": "main", "message": "Starting application initialization...", "module": "main", "function": "startup_event", "line": 212}
{"timestamp": "2025-09-05T13:39:17.969289Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Initializing database connection...", "module": "database_manager", "function": "initialize_database", "line": 337}
{"timestamp": "2025-09-05T13:39:19.580410Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Database connection established successfully", "module": "database_manager", "function": "connect", "line": 177}
{"timestamp": "2025-09-05T13:39:19.580856Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Database initialization completed successfully", "module": "database_manager", "function": "initialize_database", "line": 340}
{"timestamp": "2025-09-05T13:39:19.581389Z", "level": "INFO", "logger": "main", "message": "Application initialization completed successfully", "module": "main", "function": "startup_event", "line": 225}
{"timestamp": "2025-09-05T13:39:20.391556Z", "level": "INFO", "logger": "root", "message": "Successfully initialized 3 database collections with Beanie ODM", "module": "user_controller", "function": "initialize", "line": 62}
{"timestamp": "2025-09-05T13:51:49.704432Z", "level": "INFO", "logger": "root", "message": "Logging configured successfully", "module": "logging_config", "function": "setup_logging", "line": 162}
{"timestamp": "2025-09-05T13:51:49.704691Z", "level": "INFO", "logger": "main", "message": "Starting MonkeyZ API application...", "module": "main", "function": "<module>", "line": 36}
{"timestamp": "2025-09-05T13:51:49.761809Z", "level": "INFO", "logger": "src.middleware.security_middleware", "message": "Security middleware initialized (development: True)", "module": "security_middleware", "function": "__init__", "line": 110}
{"timestamp": "2025-09-05T13:51:49.762166Z", "level": "INFO", "logger": "main", "message": "Starting application initialization...", "module": "main", "function": "startup_event", "line": 212}
{"timestamp": "2025-09-05T13:51:49.762508Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Initializing database connection...", "module": "database_manager", "function": "initialize_database", "line": 337}
{"timestamp": "2025-09-05T13:51:50.897375Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Database connection established successfully", "module": "database_manager", "function": "connect", "line": 177}
{"timestamp": "2025-09-05T13:51:50.898072Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Database initialization completed successfully", "module": "database_manager", "function": "initialize_database", "line": 340}
{"timestamp": "2025-09-05T13:51:50.898907Z", "level": "INFO", "logger": "main", "message": "Application initialization completed successfully", "module": "main", "function": "startup_event", "line": 225}
{"timestamp": "2025-09-05T13:51:51.722291Z", "level": "INFO", "logger": "root", "message": "Successfully initialized 3 database collections with Beanie ODM", "module": "user_controller", "function": "initialize", "line": 62}
{"timestamp": "2025-09-05T15:05:03.468767Z", "level": "INFO", "logger": "main", "message": "Starting application shutdown...", "module": "main", "function": "shutdown_event", "line": 230}
{"timestamp": "2025-09-05T15:05:03.469660Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Cleaning up database connections...", "module": "database_manager", "function": "cleanup_database", "line": 347}
{"timestamp": "2025-09-05T15:05:03.543044Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Database cleanup completed", "module": "database_manager", "function": "cleanup_database", "line": 349}
{"timestamp": "2025-09-05T15:05:03.543646Z", "level": "INFO", "logger": "main", "message": "Application shutdown completed", "module": "main", "function": "shutdown_event", "line": 232}
{"timestamp": "2025-09-05T15:05:12.900617Z", "level": "INFO", "logger": "root", "message": "Logging configured successfully", "module": "logging_config", "function": "setup_logging", "line": 162}
{"timestamp": "2025-09-05T15:05:12.901252Z", "level": "INFO", "logger": "main", "message": "Starting MonkeyZ API application...", "module": "main", "function": "<module>", "line": 36}
{"timestamp": "2025-09-05T15:05:13.023086Z", "level": "INFO", "logger": "src.middleware.security_middleware", "message": "Security middleware initialized (development: True)", "module": "security_middleware", "function": "__init__", "line": 110}
{"timestamp": "2025-09-05T15:05:13.023875Z", "level": "INFO", "logger": "main", "message": "Starting application initialization...", "module": "main", "function": "startup_event", "line": 212}
{"timestamp": "2025-09-05T15:05:13.024534Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Initializing database connection...", "module": "database_manager", "function": "initialize_database", "line": 337}
{"timestamp": "2025-09-05T15:05:14.172103Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Database connection established successfully", "module": "database_manager", "function": "connect", "line": 177}
{"timestamp": "2025-09-05T15:05:14.173115Z", "level": "INFO", "logger": "src.lib.database_manager", "message": "Database initialization completed successfully", "module": "database_manager", "function": "initialize_database", "line": 340}
{"timestamp": "2025-09-05T15:05:14.175772Z", "level": "INFO", "logger": "main", "message": "Application initialization completed successfully", "module": "main", "function": "startup_event", "line": 225}
{"timestamp": "2025-09-05T15:05:14.990193Z", "level": "INFO", "logger": "root", "message": "Successfully initialized 3 database collections with Beanie ODM", "module": "user_controller", "function": "initialize", "line": 62}
{"timestamp": "2025-09-05T15:05:43.779401Z", "level": "INFO", "logger": "src.routers.orders", "message": "Coupon validation request: {'code': 'tes', 'amount': 4, 'email': None}", "module": "orders", "function": "validate_coupon_public", "line": 257}
{"timestamp": "2025-09-05T15:05:43.779976Z", "level": "INFO", "logger": "src.routers.orders", "message": "Attempting to validate coupon: code=tes, amount=4, email=None", "module": "orders", "function": "validate_coupon_public", "line": 272}
{"timestamp": "2025-09-05T15:05:43.861330Z", "level": "INFO", "logger": "src.routers.orders", "message": "Coupons in 'admin' database: 2", "module": "orders", "function": "validate_coupon_public", "line": 288}
{"timestamp": "2025-09-05T15:05:43.861971Z", "level": "INFO", "logger": "src.routers.orders", "message": "Using 'admin' database as it contains coupons", "module": "orders", "function": "validate_coupon_public", "line": 291}
{"timestamp": "2025-09-05T15:05:43.862506Z", "level": "INFO", "logger": "src.routers.orders", "message": "CouponService initialized with main database for order counting", "module": "orders", "function": "validate_coupon_public", "line": 299}
{"timestamp": "2025-09-05T15:05:43.863564Z", "level": "INFO", "logger": "src.routers.orders", "message": "\ud83c\udfaf CALLING validate_coupon with: code=tes, amount=4, email=None", "module": "orders", "function": "validate_coupon_public", "line": 311}
{"timestamp": "2025-09-05T15:05:43.864239Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "=== VALIDATE_COUPON START ===", "module": "coupon_service", "function": "validate_coupon", "line": 332}
{"timestamp": "2025-09-05T15:05:43.865039Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "Input: code='tes', total=4, email='None'", "module": "coupon_service", "function": "validate_coupon", "line": 333}
{"timestamp": "2025-09-05T15:05:43.865836Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "Accessing admin database through client for coupons", "module": "coupon_service", "function": "_get_coupons_collection", "line": 25}
{"timestamp": "2025-09-05T15:05:43.866576Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "Searching for coupon with code: 'tes' (case-insensitive)", "module": "coupon_service", "function": "validate_coupon", "line": 342}
{"timestamp": "2025-09-05T15:05:43.941861Z", "level": "WARNING", "logger": "src.services.coupon_service", "message": "Coupon not found: 'tes'", "module": "coupon_service", "function": "validate_coupon", "line": 347}
{"timestamp": "2025-09-05T15:05:43.942351Z", "level": "INFO", "logger": "src.routers.orders", "message": "\ud83c\udfaf validate_coupon returned: discount=0.0, coupon=False, error='Coupon code 'tes' not found or not active.'", "module": "orders", "function": "validate_coupon_public", "line": 313}
{"timestamp": "2025-09-05T15:05:43.942747Z", "level": "WARNING", "logger": "src.routers.orders", "message": "\ud83d\udea8 Coupon validation FAILED: Coupon code 'tes' not found or not active.", "module": "orders", "function": "validate_coupon_public", "line": 329}
{"timestamp": "2025-09-05T15:05:47.159661Z", "level": "INFO", "logger": "src.routers.orders", "message": "Coupon validation request: {'code': 'test60', 'amount': 4, 'email': None}", "module": "orders", "function": "validate_coupon_public", "line": 257}
{"timestamp": "2025-09-05T15:05:47.160373Z", "level": "INFO", "logger": "src.routers.orders", "message": "Attempting to validate coupon: code=test60, amount=4, email=None", "module": "orders", "function": "validate_coupon_public", "line": 272}
{"timestamp": "2025-09-05T15:05:47.231513Z", "level": "INFO", "logger": "src.routers.orders", "message": "Coupons in 'admin' database: 2", "module": "orders", "function": "validate_coupon_public", "line": 288}
{"timestamp": "2025-09-05T15:05:47.232542Z", "level": "INFO", "logger": "src.routers.orders", "message": "Using 'admin' database as it contains coupons", "module": "orders", "function": "validate_coupon_public", "line": 291}
{"timestamp": "2025-09-05T15:05:47.233563Z", "level": "INFO", "logger": "src.routers.orders", "message": "CouponService initialized with main database for order counting", "module": "orders", "function": "validate_coupon_public", "line": 299}
{"timestamp": "2025-09-05T15:05:47.234206Z", "level": "INFO", "logger": "src.routers.orders", "message": "\ud83c\udfaf CALLING validate_coupon with: code=test60, amount=4, email=None", "module": "orders", "function": "validate_coupon_public", "line": 311}
{"timestamp": "2025-09-05T15:05:47.234791Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "=== VALIDATE_COUPON START ===", "module": "coupon_service", "function": "validate_coupon", "line": 332}
{"timestamp": "2025-09-05T15:05:47.235431Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "Input: code='test60', total=4, email='None'", "module": "coupon_service", "function": "validate_coupon", "line": 333}
{"timestamp": "2025-09-05T15:05:47.235989Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "Accessing admin database through client for coupons", "module": "coupon_service", "function": "_get_coupons_collection", "line": 25}
{"timestamp": "2025-09-05T15:05:47.236735Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "Searching for coupon with code: 'test60' (case-insensitive)", "module": "coupon_service", "function": "validate_coupon", "line": 342}
{"timestamp": "2025-09-05T15:05:47.307184Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "\ud83d\udd0d Found coupon: test60 (ID: 68b843cabca9a42d16a1fdfc)", "module": "coupon_service", "function": "validate_coupon", "line": 350}
{"timestamp": "2025-09-05T15:05:47.308699Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "\ud83d\udd0d RAW Coupon data: {'_id': ObjectId('68b843cabca9a42d16a1fdfc'), 'code': 'test60', 'discountType': 'percentage', 'discountValue': 60.0, 'discountPercent': None, 'active': True, 'expiresAt': None, 'maxUses': 2, 'usageCount': 1, 'maxUsagePerUser': 1, 'createdAt': datetime.datetime(2025, 9, 3, 13, 34, 2, 254000, tzinfo=FixedOffset(datetime.timedelta(0), 'UTC')), 'usageAnalytics': {'total_orders': 1, 'completed': 0, 'cancelled': 0, 'pending': 0, 'processing': 0, 'awaiting_stock': 1, 'failed': 0}, 'userUsages': {'mrbrownaffiliate@gmail.com': 1}}", "module": "coupon_service", "function": "validate_coupon", "line": 351}
{"timestamp": "2025-09-05T15:05:47.309572Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "\ud83d\udd0d Coupon fields: active=True, maxUses=2, maxUsagePerUser=1", "module": "coupon_service", "function": "validate_coupon", "line": 352}
{"timestamp": "2025-09-05T15:05:47.310088Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "\ud83d\udd0d Discount: type=percentage, value=60.0", "module": "coupon_service", "function": "validate_coupon", "line": 353}
{"timestamp": "2025-09-05T15:05:47.310725Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "\ud83d\udd0d Per-user limit check: maxUsagePerUser=1 (type: <class 'int'>)", "module": "coupon_service", "function": "validate_coupon", "line": 371}
{"timestamp": "2025-09-05T15:05:47.311493Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "\ud83d\udd0d EFFECTIVE per-user limit: 1", "module": "coupon_service", "function": "validate_coupon", "line": 386}
{"timestamp": "2025-09-05T15:05:47.312626Z", "level": "INFO", "logger": "src.services.coupon_service", "message": "\ufffd ENFORCING per-user limit of 1", "module": "coupon_service", "function": "validate_coupon", "line": 390}
{"timestamp": "2025-09-05T15:05:47.313570Z", "level": "WARNING", "logger": "src.services.coupon_service", "message": "\ufffd BLOCKED: No email provided for per-user coupon", "module": "coupon_service", "function": "validate_coupon", "line": 395}
{"timestamp": "2025-09-05T15:05:47.314295Z", "level": "INFO", "logger": "src.routers.orders", "message": "\ud83c\udfaf validate_coupon returned: discount=0.0, coupon=False, error='This coupon requires an email address. Please enter your email first.'", "module": "orders", "function": "validate_coupon_public", "line": 313}
{"timestamp": "2025-09-05T15:05:47.314997Z", "level": "WARNING", "logger": "src.routers.orders", "message": "\ud83d\udea8 Coupon validation FAILED: This coupon requires an email address. Please enter your email first.", "module": "orders", "function": "validate_coupon_public", "line": 329}
{"timestamp": "2025-09-05T15:09:24.006439Z", "level": "INFO", "logger": "src.mongodb.users_collection", "message": "Login attempt with: evya00", "module": "users_collection", "function": "login", "line": 102}
{"timestamp": "2025-09-05T15:09:24.007312Z", "level": "INFO", "logger": "src.mongodb.users_collection", "message": "Attempting to find user by username: evya00", "module": "users_collection", "function": "login", "line": 120}
{"timestamp": "2025-09-05T15:09:24.084851Z", "level": "INFO", "logger": "src.mongodb.users_collection", "message": "User found, verifying password for user: evya00", "module": "users_collection", "function": "login", "line": 134}
{"timestamp": "2025-09-05T15:09:24.786211Z", "level": "INFO", "logger": "src.mongodb.users_collection", "message": "Login successful for user: evya00", "module": "users_collection", "function": "login", "line": 139}
